category: Policy
difficulty: Medium
kind: cp.simulator/scenario:1.0.0
objective: Use privileged container to get host secrets.
tasks:
  "1":
    hints:
    - penalty: 10
      text: What mounts do I have in this container.
    - penalty: 10
      text: Hmm that's a lot of devices mounted to /dev.
    - penalty: 10
      text: Is this a privileged container?
    - penalty: 10
      text: I think I can mount the host disk.
    - penalty: 10
      text: Looks like the xvda1 is the host disk.
    - penalty: 10
      text: The secret I need is in the node-secret directory.
    sortOrder: 1
    startingPoint:
      mode: pod
      podName: ci
      podNamespace: node-secret-breach
    summary: Using the fact that we were in a privileged container, we mounted the
      host disk to find a secret.
name: node-secret-breach

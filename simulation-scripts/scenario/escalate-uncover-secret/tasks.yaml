category: KubeCon
difficulty: KubeCon
kind: cp.simulator/scenario:1.0.0
objective: Use privileged container to get host secrets.
tasks:
  "1":
    hints:
    - penalty: 10
      text: I wonder if I can see the host processes in this container since it is
        a process monitor?
    - penalty: 10
      text: Hmm, if I can see the proccesses I wonder what /proc looks like?
    - penalty: 10
      text: I'm looking for a postgres process so I should find its pid and check
        /proc for that pid.
    - penalty: 10
      text: Let's see if /proc/<pid>/environ has one of the values we need.
    - penalty: 10
      text: What's in /proc/<pid>/root?
    - penalty: 10
      text: The final secrets I need are in /proc/<pid>/root/secrets.
    sortOrder: 1
    startingPoint:
      mode: pod
      podName: process-audit
      podNamespace: escalate-uncover-secret
    summary: Using the elevated permissions on the pod, we managed to manipulate the
      node /proc to retrieve secrets from another pod.
name: escalate-uncover-secret

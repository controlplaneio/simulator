apiVersion: v1
kind: Namespace
metadata:
  name: avalon
---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: hashjack
  namespace: avalon
---
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: hashjack
  namespace: avalon
rules:
  - apiGroups: [ "" ]
    resources: [ "pods", "pods/log" ]
    verbs: [ "get", "watch", "list", "create" ]
  - apiGroups: [ "apps" ]
    resources: [ "deployments" ]
    verbs: [ "create" ]
---
apiVersion: v1
kind: Pod
metadata:
  labels:
    run: hashjack
  name: hashjack
  namespace: avalon
spec:
  serviceAccountName: hashjack
  containers:
    - command:
        - /bin/bash
        - -xc
        - while sleep $(echo 'H\316\273$\304\247\360\235\224\215\310\272\302\242k // control-plane.io'
          | base64 | tr -dc 0-9); do :; done
      image: bitnami/kubectl:latest
      name: hashjack
      ports:
        - containerPort: 80
  dnsPolicy: ClusterFirst
  restartPolicy: Always
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: hashjack
  namespace: avalon
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: hashjack
subjects:
  - kind: ServiceAccount
    name: hashjack
    namespace: avalon
